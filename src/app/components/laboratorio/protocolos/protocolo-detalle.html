<div class="row">
    <!--Panel de Agendas-->
    <div class="col">
        <plex-box>
            <header>
                <!--Botones / Acciones-->
                <div class="clearfix">
                    <div class="page-title float-left">Punto de inicio | Laboratorio</div>
                    <botones-agenda *ngIf="agendasSeleccionadas?.length > 0 && agendas?.length" class="float-right" [agendasSeleccionadas]="agendasSeleccionadas"
                        (clonarEmit)="clonar()" (agregarNotaAgendaEmit)="agregarNotaAgenda()" (agregarSobreturnoEmit)="agregarSobreturno()"
                        (editarAgendaEmit)="editarAgenda($event)" (actualizarEstadoEmit)="actualizarEstadoEmit($event)"
                        (listarTurnosEmit)="listarTurnos($event)" (listarCarpetasEmit)="listarCarpetas($event)" (revisionAgendaEmit)="revisionAgenda($event)"
                        (reasignarTurnosEmit)="reasignarTurnos($event)" [turnosSuspendidos]="turnosSuspendidos">
                    </botones-agenda>
                </div>
                {{protocolo.numero?.valor}}
                <!--Filtros-->
                <div class="row">
                    <div class="{{showEditarAgendaPanel && agendasSeleccionadas?.length === 1 ? 'col-6' : 'col-3'}}">
                        <plex-datetime type="date" [(ngModel)]="fechaDesde" (change)="refreshSelection($event,'fechaDesde')" name="fechaDesde" label="Desde"
                            class="fechas">
                        </plex-datetime>
                        <!-- <plex-button type="info" icon="chevron-right"></plex-button> -->
                    </div>
                    <div class="{{showEditarAgendaPanel && agendasSeleccionadas?.length === 1 ? 'col-6' : 'col-3'}}">
                        <plex-datetime type="date" [(ngModel)]="fechaHasta" (change)="refreshSelection($event,'fechaHasta')" name="fechaHasta" label="Hasta"
                            class="fechas">
                        </plex-datetime>
                    </div>
                    <div class="{{showEditarAgendaPanel && agendasSeleccionadas?.length === 1 ? 'col-4' : 'col-2'}} text-right">
                        <label>
                            <!--Spacer-->&nbsp;</label>
                        <plex-button type="default" [icon]="mostrarMasOpciones ? 'chevron-up' : 'chevron-down'" (click)="mostrarMasOpciones = !mostrarMasOpciones"></plex-button>
                    </div>
                </div>
                <div class="row" *ngIf="mostrarMasOpciones">
                    <div class="col-4">
                        <plex-select [(ngModel)]="profesionales" (change)="refreshSelection($event, 'profesionales')" (getData)="loadProfesionales($event)"
                            name="profesionales" label="Profesional" placeholder="Buscar un profesional" labelField="apellido+' '+nombre"
                            ngModelOptions="{standalone: true}">
                        </plex-select>
                    </div>
                    <div class="col-4">
                        <plex-select [(ngModel)]="modelo.espacioFisico" (change)="refreshSelection($event,'espacioFisico')" name="espacioFisico"
                            (getData)="loadEspacios($event)" label="Espacio Físico" placeholder="Buscar un espacio físico"
                            labelField="nombre + ' - ' + (servicio ? servicio.nombre : '' ) + ' (' + edificio ? edificio.descripcion : '' + ')'"
                            ngModelOptions="{standalone: true}">
                        </plex-select>
                    </div>
                    <div class="col-4">
                        <plex-select [(ngModel)]="estado" (change)="refreshSelection($event,'estado')" [data]="estadosAgendaArray" name="estado"
                            label="Estado" ngModelOptions="{standalone: true}">
                        </plex-select>
                    </div>
                </div>
            </header>

            <!--Resultados-->
            
            <table *ngIf="protocolo.ejecucion?.registros.length" class="table table-striped table-sm">
                <thead>
                    <th></th>
                    <th>Fecha y Hora</th>
                    <th>ObjectId</th>
                    
                </thead>
                <tbody>
                    
                    <ng-container *ngFor="let practica of protocolo.ejecucion.registros; let i=index" >
                        <ng-container *ngIf="practica.registros.length > 0" >
                            <tr *ngFor="let practicaSimple of practica.registros; let y=index" class="hover" [ngClass]="" >
                                <td (click)="verAgenda(protocolo, true, $event)">
                                </td>
                                <td (click)="verAgenda(protocolo, false, $event)">
                                    <span class="float-right">{{practicaSimple.concepto.conceptId}}</span>
                                </td>
                                <td (click)="verAgenda(protocolo, false, $event)">
                                    <span class="float-right">{{practicaSimple.nombre}}</span>
                                </td>
                                <td (click)="verAgenda(protocolo, false, $event)" class="text-right align-middle estado">
                                    
                                </td>
                            </tr>
                        </ng-container>
                        <ng-container *ngIf="!practica.registros.length > 0" ></ng-container>
                            <tr class="hover" [ngClass]="" >
                                <td (click)="verAgenda(protocolo, true, $event)">
                                </td>
                                <td (click)="verAgenda(protocolo, false, $event)">
                                    <span class="float-right">{{practica.concepto.conceptId}}</span>
                                </td>
                                <td (click)="verAgenda(protocolo, false, $event)">
                                    <span class="float-right">{{practica.nombre}}</span>
                                </td>
                                <td (click)="verAgenda(protocolo, false, $event)" class="text-right align-middle estado">
                                    
                                </td>
                            </tr>
                    </ng-container>
                    <tr *ngFor="" class="hover" [ngClass]="" >

                    <tr *ngFor="let practica of protocolo.ejecucion.registros; let i=index" class="hover" [ngClass]="" >


                    
                </tbody>
            </table>
        </plex-box>
    </div>

    <!-- Panel derecho -->
    <div *ngIf="agendasSeleccionadas?.length > 0" [ngClass]="{'col-8': showEditarAgendaPanel && agendasSeleccionadas?.length === 1, 'col-4': !showEditarAgendaPanel}">
        <plex-box>
            <div *ngIf="showTurnos && agendasSeleccionadas?.length == 1 && !showSuspenderTurnos" type="info">
                <turnos [agenda]="agendasSeleccionadas[0]" (reasignaTurno)="reasignaTurno($event)" (recargarAgendas)="loadAgendas($event)"></turnos>
            </div>
            <div *ngIf="showEditarAgendaPanel && agendasSeleccionadas?.length === 1" type="info">
                <panel-agenda [editaAgendaPanel]="agendasSeleccionadas[0]" (showVistaTurnosEmit)="showVistaTurnos($event)" (actualizarEstadoEmit)="actualizarEstadoEmit($event)"
                    (editarEsapcioFisicoEmit)="true" #guardarAgendaPanel></panel-agenda>
            </div>
            <!-- Muestra el panel de Notas de Agendas -->
            <div *ngIf="showAgregarNotaAgenda">
                <nota-agenda (saveAgregarNotaAgenda)="saveAgregarNotaAgenda($event)" (cancelaAgregarNotaAgenda)="cancelaAgregarNotaAgenda($event)"
                    (showVistaTurnos)="showVistaTurnos($event)" [agendasSeleccionadas]="agendasSeleccionadas"></nota-agenda>
            </div>
            <!-- Panel Suspender Turno -->
            <div *ngIf="showSuspenderAgenda || showSuspendida">
                <suspender-agenda [agenda]="agenda" (returnSuspenderAgenda)="cerrarSuspenderTurno(agenda)">
                </suspender-agenda>
            </div>

            <!-- FUNCINALIDAD REASIGNACION AUTOMATICA QUEDA AFUERA DEL RELEASE DOMUYO -->
            <!-- Panel Reasignar Turnos Automático -->
            <!-- <div *ngIf="showReasignarTurnoAutomatico && !showSuspenderTurnos">
                <reasignar-turno-automatico [agendaAReasignar]="agendasSeleccionadas[0]" (reasignarTurnosEmit)="reasignarTurnos($event)"></reasignar-turno-automatico>
            </div> -->
        </plex-box>
    </div>

</div>
